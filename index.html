<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Master - Gamified Learning Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .hidden {
            display: none !important;
        }

        /* Auth Screens */
        .auth-container {
            max-width: 450px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 1em;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 15px 40px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
            margin-top: 15px;
        }

        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }

        .text-center {
            text-align: center;
            margin-top: 20px;
            color: #666;
        }

        .link {
            color: #667eea;
            cursor: pointer;
            font-weight: 600;
        }

        .link:hover {
            text-decoration: underline;
        }

        /* Dashboard */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
        }

        .user-info h2 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .user-info p {
            opacity: 0.9;
        }

        .logout-btn {
            padding: 10px 25px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: white;
            color: #667eea;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-card .label {
            color: #666;
            font-size: 1em;
        }

        .achievements {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .achievements h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .badges {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .badge {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1em;
        }

        .badge.earned {
            border-color: #ffd700;
            background: #fffef0;
        }

        .badge.locked {
            opacity: 0.5;
        }

        .quiz-selection {
            background: white;
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
        }

        .quiz-selection h3 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 1.5em;
        }

        .selection-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        /* Quiz Screen */
        .quiz-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .question-counter {
            font-size: 1.1em;
            color: #667eea;
            font-weight: 600;
        }

        .timer {
            font-size: 1.3em;
            color: #764ba2;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .timer.warning {
            color: #e74c3c;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .question-section {
            margin-bottom: 30px;
        }

        .question {
            font-size: 1.4em;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.6;
            font-weight: 500;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            padding: 18px 24px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            background: white;
        }

        .option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #667eea;
            background: #f0f3ff;
        }

        .option.correct {
            border-color: #27ae60;
            background: #d5f4e6;
            animation: correctAnswer 0.5s ease;
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: #fadbd8;
            animation: shake 0.5s ease;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        @keyframes correctAnswer {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
            text-align: center;
            font-weight: 500;
        }

        .feedback.correct {
            background: #d5f4e6;
            color: #27ae60;
        }

        .feedback.incorrect {
            background: #fadbd8;
            color: #e74c3c;
        }

        /* Results */
        .results {
            text-align: center;
        }

        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 30px auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.4);
        }

        .score-circle .score {
            font-size: 3em;
            font-weight: 700;
        }

        .score-circle .label {
            font-size: 1.2em;
            margin-top: 5px;
        }

        .results h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .results-details {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .results-details p {
            font-size: 1.2em;
            margin: 10px 0;
            color: #555;
        }

        .new-badges {
            background: #fffef0;
            border: 2px solid #ffd700;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .new-badges h3 {
            color: #f39c12;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📚 Quiz Master</h1>
            <p>Gamified Learning Platform</p>
        </div>

        <!-- Login Screen -->
        <div id="loginScreen" class="auth-container">
            <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">Welcome Back!</h2>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="loginEmail" placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password">
            </div>
            <button class="btn btn-primary" onclick="login()">Login</button>
            <button class="btn btn-secondary" onclick="showRegister()">Create New Account</button>
        </div>

        <!-- Register Screen -->
        <div id="registerScreen" class="auth-container hidden">
            <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">Create Account</h2>
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="regName" placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="regEmail" placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="regPassword" placeholder="Create a password">
            </div>
            <div class="form-group">
                <label>Standard/Grade</label>
                <select id="regStandard">
                    <option value="">Select Standard</option>
                    <option value="6">Grade 6</option>
                    <option value="7">Grade 7</option>
                    <option value="8">Grade 8</option>
                    <option value="9">Grade 9</option>
                    <option value="10">Grade 10</option>
                    <option value="11">Grade 11</option>
                    <option value="12">Grade 12</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="register()">Register</button>
            <button class="btn btn-secondary" onclick="showLogin()">Already have an account? Login</button>
        </div>

        <!-- Dashboard Screen -->
        <div id="dashboardScreen" class="hidden">
            <div class="dashboard-header">
                <div class="user-info">
                    <h2 id="userName">Welcome!</h2>
                    <p id="userGrade">Grade 10</p>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="icon">🏆</div>
                    <div class="value" id="totalScore">0</div>
                    <div class="label">Total Points</div>
                </div>
                <div class="stat-card">
                    <div class="icon">✅</div>
                    <div class="value" id="quizzesTaken">0</div>
                    <div class="label">Quizzes Taken</div>
                </div>
                <div class="stat-card">
                    <div class="icon">🎯</div>
                    <div class="value" id="avgAccuracy">0%</div>
                    <div class="label">Avg Accuracy</div>
                </div>
                <div class="stat-card">
                    <div class="icon">🔥</div>
                    <div class="value" id="streak">0</div>
                    <div class="label">Day Streak</div>
                </div>
            </div>

            <div class="achievements">
                <h3>🏅 Achievements</h3>
                <div class="badges" id="badgesContainer"></div>
            </div>

            <div class="quiz-selection">
                <h3>Start a New Quiz</h3>
                <div class="selection-grid">
                    <div class="form-group">
                        <label>Select Subject</label>
                        <select id="subjectSelect">
                            <option value="">Choose Subject</option>
                            <option value="math">Mathematics</option>
                            <option value="science">Science</option>
                            <option value="history">History</option>
                            <option value="geography">Geography</option>
                            <option value="english">English</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Difficulty</label>
                        <select id="difficultySelect">
                            <option value="easy">Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="startQuiz()">Start Quiz</button>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quizScreen" class="hidden">
            <div class="quiz-info">
                <div class="question-counter">
                    Question <span id="currentQuestion">1</span> of <span id="totalQuestions">10</span>
                </div>
                <div class="timer" id="timer">
                    ⏱️ <span id="timeLeft">30</span>s
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>

            <div class="question-section">
                <div class="question" id="question"></div>
                <div class="options" id="options"></div>
                <div id="feedback" class="feedback hidden"></div>
            </div>

            <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">Next Question</button>
        </div>

        <!-- Results Screen -->
        <div id="resultsScreen" class="results hidden">
            <h2>🎉 Quiz Complete!</h2>
            <div class="score-circle">
                <div class="score" id="finalScore">0</div>
                <div class="label">out of 10</div>
            </div>
            <div class="results-details">
                <p>Points Earned: <strong id="pointsEarned">0</strong> 🏆</p>
                <p>Correct Answers: <strong id="correctCount">0</strong></p>
                <p>Accuracy: <strong id="accuracy">0%</strong></p>
                <p>Time Taken: <strong id="timeTaken">0s</strong></p>
            </div>
            <div id="newBadges" class="new-badges hidden">
                <h3>🎖️ New Achievements Unlocked!</h3>
                <div id="newBadgesContainer"></div>
            </div>
            <button class="btn btn-primary" onclick="backToDashboard()">Back to Dashboard</button>
        </div>
    </div>

    <script>
        // Quiz questions by subject and standard
        const quizDatabase = {
            math: {
                6: [
                    { question: "What is 15 × 8?", options: ["120", "125", "115", "130"], correct: 0 },
                    { question: "What is the area of a rectangle with length 10 and width 5?", options: ["15", "50", "25", "100"], correct: 1 },
                    { question: "Simplify: 3/6", options: ["1/3", "1/2", "2/3", "1/4"], correct: 1 },
                    { question: "What is 25% of 200?", options: ["25", "50", "75", "100"], correct: 1 },
                    { question: "What is the perimeter of a square with side 7?", options: ["14", "21", "28", "49"], correct: 2 },
                    { question: "Solve: 3x = 15", options: ["x = 3", "x = 5", "x = 12", "x = 18"], correct: 1 },
                    { question: "What is 2³?", options: ["4", "6", "8", "9"], correct: 2 },
                    { question: "What is the LCM of 4 and 6?", options: ["10", "12", "18", "24"], correct: 1 },
                    { question: "Convert 0.75 to a fraction", options: ["3/4", "2/3", "3/5", "4/5"], correct: 0 },
                    { question: "What is 144 ÷ 12?", options: ["10", "11", "12", "13"], correct: 2 }
                ],
                10: [
                    { question: "Solve: x² - 5x + 6 = 0", options: ["x = 2, 3", "x = 1, 6", "x = -2, -3", "x = 0, 5"], correct: 0 },
                    { question: "What is sin(30°)?", options: ["1/2", "√3/2", "1", "0"], correct: 0 },
                    { question: "Find the derivative of x²", options: ["x", "2x", "x²", "2"], correct: 1 },
                    { question: "What is log₁₀(100)?", options: ["1", "2", "10", "100"], correct: 1 },
                    { question: "Distance formula in 2D?", options: ["√((x₂-x₁)² + (y₂-y₁)²)", "(x₂-x₁) + (y₂-y₁)", "x₂ + y₂", "None"], correct: 0 },
                    { question: "What is the value of π (approximately)?", options: ["3.14", "3.41", "2.71", "1.41"], correct: 0 },
                    { question: "Expand: (a+b)²", options: ["a² + b²", "a² + 2ab + b²", "a² - b²", "2a² + 2b²"], correct: 1 },
                    { question: "What is the slope of line y = 3x + 2?", options: ["2", "3", "5", "-3"], correct: 1 },
                    { question: "Factor: x² - 9", options: ["(x-3)(x-3)", "(x+3)(x-3)", "(x+9)(x-1)", "Cannot factor"], correct: 1 },
                    { question: "What is 0! (factorial)?", options: ["0", "1", "Undefined", "10"], correct: 1 }
                ]
            },
            science: {
                6: [
                    { question: "What is the process by which plants make food?", options: ["Respiration", "Photosynthesis", "Digestion", "Absorption"], correct: 1 },
                    { question: "What is the center of an atom called?", options: ["Electron", "Proton", "Nucleus", "Neutron"], correct: 2 },
                    { question: "Which planet is closest to the Sun?", options: ["Venus", "Earth", "Mercury", "Mars"], correct: 2 },
                    { question: "What gas do plants absorb from the atmosphere?", options: ["Oxygen", "Nitrogen", "Carbon dioxide", "Hydrogen"], correct: 2 },
                    { question: "What is the boiling point of water?", options: ["0°C", "50°C", "100°C", "200°C"], correct: 2 },
                    { question: "What is the largest organ in the human body?", options: ["Heart", "Brain", "Liver", "Skin"], correct: 3 },
                    { question: "How many bones are in the adult human body?", options: ["186", "206", "256", "306"], correct: 1 },
                    { question: "What force pulls objects toward Earth?", options: ["Magnetism", "Friction", "Gravity", "Tension"], correct: 2 },
                    { question: "What is the chemical symbol for water?", options: ["H2O", "CO2", "O2", "NaCl"], correct: 0 },
                    { question: "Which animal is known as the 'Ship of the Desert'?", options: ["Horse", "Camel", "Elephant", "Donkey"], correct: 1 }
                ],
                10: [
                    { question: "What is the SI unit of force?", options: ["Joule", "Newton", "Watt", "Pascal"], correct: 1 },
                    { question: "What is the chemical formula for sulfuric acid?", options: ["HCl", "H2SO4", "HNO3", "H2CO3"], correct: 1 },
                    { question: "What is the powerhouse of the cell?", options: ["Nucleus", "Ribosome", "Mitochondria", "Chloroplast"], correct: 2 },
                    { question: "What is Ohm's Law?", options: ["V = IR", "F = ma", "E = mc²", "P = VI"], correct: 0 },
                    { question: "What is the atomic number of Carbon?", options: ["4", "6", "8", "12"], correct: 1 },
                    { question: "What type of bond involves sharing of electrons?", options: ["Ionic", "Covalent", "Metallic", "Hydrogen"], correct: 1 },
                    { question: "What is the speed of light in vacuum?", options: ["3 × 10⁸ m/s", "3 × 10⁶ m/s", "3 × 10⁷ m/s", "3 × 10⁹ m/s"], correct: 0 },
                    { question: "What is the pH of a neutral solution?", options: ["0", "7", "14", "1"], correct: 1 },
                    { question: "What is the unit of electric current?", options: ["Volt", "Ohm", "Ampere", "Coulomb"], correct: 2 },
                    { question: "Which blood cells fight infection?", options: ["Red blood cells", "White blood cells", "Platelets", "Plasma"], correct: 1 }
                ]
            },
            history: {
                10: [
                    { question: "When did World War II end?", options: ["1943", "1944", "1945", "1946"], correct: 2 },
                    { question: "Who was the first President of the United States?", options: ["Thomas Jefferson", "George Washington", "Abraham Lincoln", "John Adams"], correct: 1 },
                    { question: "In which year did India gain independence?", options: ["1945", "1946", "1947", "1948"], correct: 2 },
                    { question: "Who wrote the Declaration of Independence?", options: ["George Washington", "Benjamin Franklin", "Thomas Jefferson", "John Adams"], correct: 2 },
                    { question: "What was the ancient trade route connecting East and West?", options: ["Spice Route", "Silk Road", "King's Highway", "Amber Road"], correct: 1 },
                    { question: "Who was known as the 'Iron Lady'?", options: ["Indira Gandhi", "Margaret Thatcher", "Angela Merkel", "Golda Meir"], correct: 1 },
                    { question: "When did the Berlin Wall fall?", options: ["1987", "1988", "1989", "1990"], correct: 2 },
                    { question: "Who discovered America in 1492?", options: ["Vasco da Gama", "Christopher Columbus", "Ferdinand Magellan", "Amerigo Vespucci"], correct: 1 },
                    { question: "What was the Renaissance?", options: ["War", "Cultural rebirth", "Political movement", "Religious reform"], correct: 1 },
                    { question: "Who was the first man on the moon?", options: ["Buzz Aldrin", "Neil Armstrong", "Yuri Gagarin", "Alan Shepard"], correct: 1 }
                ]
            },
            geography: {
                10: [
                    { question: "What is the capital of Australia?", options: ["Sydney", "Melbourne", "Canberra", "Brisbane"], correct: 2 },
                    { question: "Which is the largest ocean?", options: ["Atlantic", "Indian", "Arctic", "Pacific"], correct: 3 },
                    { question: "What is the longest river in the world?", options: ["Amazon", "Nile", "Yangtze", "Mississippi"], correct: 1 },
                    { question: "Mount Everest is located in which mountain range?", options: ["Alps", "Andes", "Himalayas", "Rockies"], correct: 2 },
                    { question: "Which country has the most time zones?", options: ["Russia", "USA", "China", "France"], correct: 3 },
                    { question: "What is the smallest country in the world?", options: ["Monaco", "Vatican City", "San Marino", "Liechtenstein"], correct: 1 },
                    { question: "Which desert is the largest in the world?", options: ["Sahara", "Arabian", "Gobi", "Antarctica"], correct: 3 },
                    { question: "What is the capital of Canada?", options: ["Toronto", "Vancouver", "Ottawa", "Montreal"], correct: 2 },
                    { question: "Which continent has the most countries?", options: ["Asia", "Africa", "Europe", "South America"], correct: 1 },
                    { question: "What is the deepest point in the ocean?", options: ["Puerto Rico Trench", "Java Trench", "Mariana Trench", "Tonga Trench"], correct: 2 }
                ]
            },
            english: {
                10: [
                    { question: "Who wrote 'Romeo and Juliet'?", options: ["Charles Dickens", "William Shakespeare", "Jane Austen", "Mark Twain"], correct: 1 },
                    { question: "What is a synonym for 'happy'?", options: ["Sad", "Joyful", "Angry", "Worried"], correct: 1 },
                    { question: "What is the past tense of 'run'?", options: ["Runned", "Ran", "Running", "Runs"], correct: 1 },
                    { question: "Identify the noun: 'The cat sleeps peacefully'", options: ["The", "Cat", "Sleeps", "Peacefully"], correct: 1 },
                    { question: "What is an antonym for 'difficult'?", options: ["Hard", "Easy", "Complex", "Challenging"], correct: 1 },
                    { question: "Who wrote '1984'?", options: ["George Orwell", "Aldous Huxley", "Ray Bradbury", "H.G. Wells"], correct: 0 },
                    { question: "What is a metaphor?", options: ["Direct comparison", "Exaggeration", "Implied comparison", "Sound imitation"], correct: 2 },
                    { question: "Identify the verb: 'She quickly ran home'", options: ["She", "Quickly", "Ran", "Home"], correct: 2 },
                    { question: "What is the superlative form of 'good'?", options: ["Gooder", "Goodest", "Better", "Best"], correct: 3 },
                    { question: "What type of sentence is: 'What a beautiful day!'?", options: ["Declarative", "Interrogative", "Exclamatory", "Imperative"], correct: 2 }
                ]
            }
        };

        // User data storage
        let users = JSON.parse(localStorage.getItem('quizUsers')) || {};
        let currentUser = null;

        // Badges/Achievements system
        const badges = [
            { id: 'first_quiz', icon: '🎯', name: 'First Steps', requirement: 1, earned: false },
            { id: 'quiz_master', icon: '🏆', name: 'Quiz Master', requirement: 5, earned: false },
            { id: 'perfect_score', icon: '💯', name: 'Perfect Score', requirement: 'score_10', earned: false },
            { id: 'speed_demon', icon: '⚡', name: 'Speed Demon', requirement: 'fast_completion', earned: false },
            { id: 'streak_week', icon: '🔥', name: 'Week Streak', requirement: 7, earned: false },
            { id: 'hundred_points', icon: '💰', name: 'Century Club', requirement: 100, earned: false }
        ];

        // Quiz state
        let currentQuestionIndex = 0;
        let score = 0;
        let timeLeft = 30;
        let timerInterval;
        let selectedAnswer = null;
        let startTime;
        let answered = false;
        let currentQuiz = [];
        let selectedSubject = '';
        let selectedDifficulty = '';

        // Show/Hide screens
        function showScreen(screenId) {
            const screens = ['loginScreen', 'registerScreen', 'dashboardScreen', 'quizScreen', 'resultsScreen'];
            screens.forEach(screen => {
                document.getElementById(screen).classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        function showLogin() {
            showScreen('loginScreen');
        }

        function showRegister() {
            showScreen('registerScreen');
        }

        // Authentication
        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert('Please fill in all fields');
                return;
            }

            if (users[email] && users[email].password === password) {
                currentUser = users[email];
                showDashboard();
            } else {
                alert('Invalid email or password');
            }
        }

        function register() {
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const standard = document.getElementById('regStandard').value;

            if (!name || !email || !password || !standard) {
                alert('Please fill in all fields');
                return;
            }

            if (users[email]) {
                alert('Email already exists');
                return;
            }

            users[email] = {
                name: name,
                email: email,
                password: password,
                standard: standard,
                totalScore: 0,
                quizzesTaken: 0,
                totalCorrect: 0,
                totalQuestions: 0,
                streak: 0,
                lastQuizDate: null,
                badges: badges.map(b => ({ ...b }))
            };

            localStorage.setItem('quizUsers', JSON.stringify(users));
            currentUser = users[email];
            showDashboard();
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            showLogin();
        }

        // Dashboard
        function showDashboard() {
            showScreen('dashboardScreen');
            document.getElementById('userName').textContent = `Welcome, ${currentUser.name}!`;
            document.getElementById('userGrade').textContent = `Grade ${currentUser.standard}`;
            document.getElementById('totalScore').textContent = currentUser.totalScore;
            document.getElementById('quizzesTaken').textContent = currentUser.quizzesTaken;
            
            const accuracy = currentUser.totalQuestions > 0 
                ? Math.round((currentUser.totalCorrect / currentUser.totalQuestions) * 100) 
                : 0;
            document.getElementById('avgAccuracy').textContent = accuracy + '%';
            document.getElementById('streak').textContent = currentUser.streak;

            // Display badges
            const badgesContainer = document.getElementById('badgesContainer');
            badgesContainer.innerHTML = '';
            currentUser.badges.forEach(badge => {
                const badgeEl = document.createElement('div');
                badgeEl.className = badge.earned ? 'badge earned' : 'badge locked';
                badgeEl.innerHTML = `<span style="font-size: 1.5em;">${badge.icon}</span> <span>${badge.name}</span>`;
                badgesContainer.appendChild(badgeEl);
            });
        }

        // Start Quiz
        function startQuiz() {
            selectedSubject = document.getElementById('subjectSelect').value;
            selectedDifficulty = document.getElementById('difficultySelect').value;

            if (!selectedSubject) {
                alert('Please select a subject');
                return;
            }

            // Get questions based on subject and user's standard
            const userStandard = currentUser.standard;
            let questions = quizDatabase[selectedSubject]?.[userStandard];

            // Fallback to grade 10 if user's standard not available
            if (!questions) {
                questions = quizDatabase[selectedSubject]?.[10];
            }

            if (!questions) {
                alert('Questions not available for this subject. Try another one!');
                return;
            }

            currentQuiz = [...questions];
            currentQuestionIndex = 0;
            score = 0;
            startTime = Date.now();
            
            showScreen('quizScreen');
            loadQuestion();
        }

        function loadQuestion() {
            answered = false;
            selectedAnswer = null;
            timeLeft = 30;
            clearInterval(timerInterval);
            
            const question = currentQuiz[currentQuestionIndex];
            document.getElementById('question').textContent = question.question;
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('totalQuestions').textContent = currentQuiz.length;
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('nextBtn').disabled = true;
            
            const progress = ((currentQuestionIndex) / currentQuiz.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            startTimer();
        }

        function startTimer() {
            const timerElement = document.getElementById('timer');
            timerElement.classList.remove('warning');
            
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timeLeft').textContent = timeLeft;
                
                if (timeLeft <= 10) {
                    timerElement.classList.add('warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (!answered) {
                        checkAnswer(-1);
                    }
                }
            }, 1000);
        }

        function selectAnswer(index) {
            if (answered) return;
            
            selectedAnswer = index;
            const options = document.querySelectorAll('.option');
            options.forEach((opt, i) => {
                opt.classList.remove('selected');
                if (i === index) {
                    opt.classList.add('selected');
                }
            });
            
            document.getElementById('nextBtn').disabled = false;
        }

        function checkAnswer(answerIndex) {
            if (answered) return;
            
            answered = true;
            clearInterval(timerInterval);
            
            const question = currentQuiz[currentQuestionIndex];
            const options = document.querySelectorAll('.option');
            const feedbackDiv = document.getElementById('feedback');
            
            options.forEach(opt => {
                opt.classList.add('disabled');
            });
            
            if (answerIndex === question.correct) {
                score++;
                options[answerIndex].classList.add('correct');
                feedbackDiv.textContent = '✓ Correct! Well done!';
                feedbackDiv.className = 'feedback correct';
            } else {
                if (answerIndex !== -1) {
                    options[answerIndex].classList.add('incorrect');
                }
                options[question.correct].classList.add('correct');
                feedbackDiv.textContent = answerIndex === -1 ? 
                    '⏰ Time\'s up! The correct answer is: ' + question.options[question.correct] :
                    '✗ Incorrect. The correct answer is: ' + question.options[question.correct];
                feedbackDiv.className = 'feedback incorrect';
            }
            
            feedbackDiv.classList.remove('hidden');
            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            if (selectedAnswer !== null && !answered) {
                checkAnswer(selectedAnswer);
                return;
            }
            
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuiz.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            clearInterval(timerInterval);
            showScreen('resultsScreen');
            
            const endTime = Date.now();
            const totalTime = Math.floor((endTime - startTime) / 1000);
            const accuracy = Math.round((score / currentQuiz.length) * 100);
            const pointsEarned = score * 10 + (accuracy === 100 ? 20 : 0); // Bonus for perfect score
            
            // Update user stats
            currentUser.totalScore += pointsEarned;
            currentUser.quizzesTaken += 1;
            currentUser.totalCorrect += score;
            currentUser.totalQuestions += currentQuiz.length;
            
            // Update streak
            const today = new Date().toDateString();
            if (currentUser.lastQuizDate !== today) {
                const yesterday = new Date(Date.now() - 86400000).toDateString();
                if (currentUser.lastQuizDate === yesterday) {
                    currentUser.streak += 1;
                } else if (currentUser.lastQuizDate !== today) {
                    currentUser.streak = 1;
                }
                currentUser.lastQuizDate = today;
            }
            
            // Check and award badges
            const newBadges = [];
            currentUser.badges.forEach(badge => {
                if (!badge.earned) {
                    let unlock = false;
                    switch(badge.id) {
                        case 'first_quiz':
                            unlock = currentUser.quizzesTaken >= 1;
                            break;
                        case 'quiz_master':
                            unlock = currentUser.quizzesTaken >= 5;
                            break;
                        case 'perfect_score':
                            unlock = score === currentQuiz.length;
                            break;
                        case 'speed_demon':
                            unlock = totalTime < 180; // Under 3 minutes
                            break;
                        case 'streak_week':
                            unlock = currentUser.streak >= 7;
                            break;
                        case 'hundred_points':
                            unlock = currentUser.totalScore >= 100;
                            break;
                    }
                    if (unlock) {
                        badge.earned = true;
                        newBadges.push(badge);
                    }
                }
            });
            
            // Save user data
            users[currentUser.email] = currentUser;
            localStorage.setItem('quizUsers', JSON.stringify(users));
            
            // Display results
            document.getElementById('finalScore').textContent = score;
            document.getElementById('pointsEarned').textContent = pointsEarned;
            document.getElementById('correctCount').textContent = score;
            document.getElementById('accuracy').textContent = accuracy + '%';
            document.getElementById('timeTaken').textContent = totalTime + 's';
            
            // Show new badges
            if (newBadges.length > 0) {
                document.getElementById('newBadges').classList.remove('hidden');
                const newBadgesContainer = document.getElementById('newBadgesContainer');
                newBadgesContainer.innerHTML = '';
                newBadges.forEach(badge => {
                    const badgeEl = document.createElement('div');
                    badgeEl.className = 'badge earned';
                    badgeEl.innerHTML = `<span style="font-size: 1.5em;">${badge.icon}</span> <span>${badge.name}</span>`;
                    newBadgesContainer.appendChild(badgeEl);
                });
            } else {
                document.getElementById('newBadges').classList.add('hidden');
            }
        }

        function backToDashboard() {
            showDashboard();
        }

        // Initialize
        window.onload = function() {
            showLogin();
        };
    </script>
</body>
</html>

